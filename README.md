# CoRE-BED
## Introduction
CoRE-BED, or Classifier of Regulatory Elements in BED coordinates, is a framework to generate cell and tissue type dependent annotation of regulatory elements. The CoRE-BED classifier is implemented as a decision tree. The tree structure is learned from training data, generating a classifier (i.e., membership in a class of regulatory elements) whose generalizability is evaluated in test data. Each internal node represents an observation that captures the physical properties of chromatin, nucleosome positioning, or access to DNA; each leaf or terminal node is a class of regulatory elements; and each link is a decision. To determine the optimal tree structure, several structures are evaluated for overlap with a set of fine-mapped expression quantitative trait loci (eQTLs) from GTEx in a broad set of cell and tissue types8 and for the information gain from the classifier using Shannon entropy.

A Python-based implementation was developed to classify the regulatory identities of regions in any genomic coordinates file. Based on each coordinate's overlap (or lack thereof) with annotated transcription start sites (TSSs); H3K4me1, H3K4me3, H3K27ac, and H3K27me3 histone marks, as well as CTCF binding and DNAse I hypersensitive (DHS) sites, it will be classified as either an active promoter, bivalent promoter, silenced promoter, CTCF binding site in an unclassified active chromatin region within the specified range limit of a TSS (default: 5 kb upstream and 1 kb downstream), CTCF binding site in an unclassified inactive chromatin region within the specified range limit of a TSS, non-CTCF binding site in an unclassified active chromatin region within the specified range limit of a TSS, non-CTCF binding site in an unclassified inactive chromatin region within the specified range limit of a TSS, active enhancer, poised enhancer, primed enhancer, CTCF binding site in an unclassified active chromatin region beyond the specified range limit of a TSS, CTCF binding site in an unclassified inactive chromatin region beyond the specified range limit of a TSS, non-CTCF binding site in an unclassified active chromatin region beyond the specified range limit of a TSS, or non-CTCF binding site in an unclassified inactive chromatin region beyond the specified range limit of a TSS. The tree structure can be visualized as follows:

![Fig1](https://user-images.githubusercontent.com/63562495/170776006-020a963f-cbf8-43f3-a299-8b4775047df9.png)

## CoRE-BED-test script
The simplest script ```core-bed_test.py``` takes in a user-provided genomic coordinates file and downloads all reference files (transcription start site coordinates, as well as H3K4me1, H3K4me3, H3K27ac, and H3K27me3 histone ChIP-seq; CTCF ChIP-seq; and DNase-seq peak coordinates generated by the ENCODE Consortium) based on the user-specified human genome build and tissue type(s). CoRE-BED provides 28 tissue options but allows for the use of user-specified reference files, as well, in the form of either local file paths or download URLs. Additionally, CoRE-BED offers compatibility with the mm39, mm10, and mm9 mouse genome builds. If your input file is in a format other than UCSC BED format (i.e. GWAS summary statistics), use the ```--bed_cols``` option to specify which numbered columns in your file contain the chromosome, start, and end coordinates (i.e. ```--bed_cols 1,2,2```). Additionally, use the ```--input_header``` flag if your non-UCSC BED input has a header. The following test samples from ENCODE were used to represent each of the 28 supported human tissue types, roughly approximating the full set of GTEx tissues:
* ```Adipose```\
**hg38**: *Homo sapiens* subcutaneous abdominal adipose tissue tissue nuclear fraction female adult (49 years) and *Homo sapiens* omental fat pad tissue female adult (51 years) (CTCF ChIP-seq and DNase-seq only)\
**hg19**: *Homo sapiens* subcutaneous abdominal adipose tissue tissue nuclear fraction female adult (49 years), *Homo sapiens* omental fat pad tissue female adult (53 years) (DNase-seq only), and *Homo sapiens** omental fat pad tissue female adult (51 years) (CTCF ChIP-seq only))
* ```Adrenal_gland```\
**hg38**: *Homo sapiens* adrenal gland tissue male embryo (97 days) and *Homo sapiens* adrenal gland tissue embryo (96 days) (DNase-seq only), and *Homo sapiens* adrenal gland tissue male adult (37 years) (CTCF ChIP-seq only)\
**hg19**: *Homo sapiens* adrenal gland tissue male embryo (97 days) and *Homo sapiens* adrenal gland tissue embryo (96 days) (DNase-seq only), and *Homo sapiens* adrenal gland tissue male adult (37 years) (CTCF ChIP-seq only)
* ```Artery```\
**hg38**: *Homo sapiens* aorta tissue male adult (34 years) and *Homo sapiens* aorta tissue female adult (41 years) (DNase-seq only), and *Homo sapiens* ascending aorta tissue female adult (51 years) (CTCF ChIP-seq only)\
**hg19**: *Homo sapiens* aorta tissue male adult (34 years) and *Homo sapiens* coronary artery tissue female adult (53 years) (DNase-seq only), and *Homo sapiens* ascending aorta tissue female adult (51 years) (CTCF ChIP-seq only)
* ```Blood```\
**hg38**: *Homo sapiens* peripheral blood mononuclear cell male adult (39 years) and *Homo sapiens* K562 (DNase-seq and CTCF ChIP-seq only)\
**hg19**: *Homo sapiens* peripheral blood mononuclear cell male adult (39 years) and *Homo sapiens* K562 (DNase-seq and CTCF ChIP-seq only)
* ```Breast```\
**hg38**: *Homo sapiens* breast epithelium tissue female adult (53 years) and *Homo sapiens* breast epithelium tissue female adult (51 years) (DNase-seq only)\
**hg19**: *Homo sapiens** breast epithelium tissue female adult (53 years) and *Homo sapiens* MCF-7 (DNase-seq only)
* ```Cultured_fibroblast```\
**hg38**: *Homo sapiens* IMR-90\
**hg19**: *Homo sapiens* IMR-90
* ```EBV_transformed_lymphocyte```\
**hg38**: *Homo sapiens* GM12878\
**hg19**: *Homo sapiens* GM12878
* ```ES```\
**hg38**: *Homo sapiens* H1 embryonic stem cell\
**hg19**: *Homo sapiens* H1 embryonic stem cell
* ```Esophagus_muscularis_mucosa```\
**hg38**: *Homo sapiens* esophagus muscularis mucosa tissue female adult (51 years) and Homo sapiens esophagus muscularis mucosa tissue male adult (37 years) (DNase-seq only)\
**hg19**: *Homo sapiens* esophagus muscularis mucosa tissue female adult (51 years) and *Homo sapiens* esophagus muscularis mucosa tissue male adult (37 years) (DNase-seq only)
* ```Esophagus_squamous_epithelium```\
**hg38**: *Homo sapiens* esophagus squamous epithelium tissue female adult (51 years) and *Homo sapiens* esophagus squamous epithelium tissue male adult (37 years) (DNase-seq only)\
**hg19**: *Homo sapiens* esophagus squamous epithelium tissue female adult (51 years) and *Homo sapiens* esophagus squamous epithelium tissue male adult (37 years) (DNase-seq only)
* ```Heart```\
**hg38**: *Homo sapiens* heart left ventricle tissue female adult (53 years)\
**hg19**: *Homo sapiens* heart left ventricle tissue female adult (53 years)
* ```Intestine```\
**hg38**: *Homo sapiens* sigmoid colon tissue male adult (37 years) and *Homo sapiens* sigmoid colon tissue female adult (53 years) (DNase-seq only)\
**hg19**: *Homo sapiens* sigmoid colon tissue male adult (37 years) and *Homo sapiens* sigmoid colon tissue female adult (53 years) (DNase-seq only)
* ```iPS```\
**hg38**: *Homo sapiens* iPS DF 19.11 and *Homo sapiens* GM23338 originated from GM23248 (CTCF ChIP-seq only))\
**hg19**: *Homo sapiens* iPS DF 19.11 and *Homo sapiens* GM23338 originated from GM23248 (CTCF ChIP-seq only))
* ```Kidney```\
**hg38**: *Homo sapiens* kidney tissue male adult (67 years), *Homo sapiens* kidney tissue female embryo (120 days) (H3K27me3 and DNase-seq only), and *Homo sapiens* kidney epithelial cell (CTCF ChIP-seq)\
**hg19**: *Homo sapiens* kidney tissue male adult (67 years), *Homo sapiens* kidney tissue female embryo (120 days) (H3K27ME3 and DNase-seq only), and *Homo sapiens* kidney epithelial cell (CTCF ChIP-seq)
* ```Liver```\
**hg38**: *Homo sapiens* liver tissue male adult (32 years), Homo sapiens liver tissue female embryo (101 days) and female embryo (113 days) (DNase-seq only), and *Homo sapiens* right lobe of liver tissue female adult (53 years) (CTCF ChIP-seq only)\
**hg19**: *Homo sapiens* liver tissue male adult (32 years), *Homo sapiens* liver tissue female embryo (101 days) and female embryo (113 days) (DNase-seq), and *Homo sapiens* right lobe of liver tissue female adult (53 years) (CTCF ChIP-seq only)
* ```Lung```\
**hg38**: *Homo sapiens* upper lobe of left lung tissue female adult (51 years)\
**hg19**: *Homo sapiens* upper lobe of left lung tissue female adult (51 years) and *Homo sapiens* upper lobe of left lung tissue male adult (37 years) (DNase-seq only)
* ```Neuron```\
**hg38**: *Homo sapiens* SK-N-SH\
**hg19**: *Homo sapiens* SK-N-SH and *Homo sapiens* tibial nerve tissue female adult (51 years) (DNase-seq only)
* ```Ovary```\
**hg38**: *Homo sapiens* ovary tissue female adult (30 years) and *Homo sapiens* ovary tissue female adult (53 years) (CTCF ChIP-seq only)\
**hg19**: *Homo sapiens* ovary tissue female adult (30 years) and *Homo sapiens* ovary tissue female adult (53 years) (CTCF ChIP-seq only)
* ```Pancreas```\
**hg38**: *Homo sapiens* pancreas tissue female adult (41 years)\
**hg19**: *Homo sapiens* pancreas tissue male adult (34 years) and *Homo sapiens* body of pancreas tissue male adult (37 years) (CTCF ChIP-seq only)
* ```Prostate```\
**hg38**: *Homo sapiens* prostate gland tissue male adult (37 years)\
**hg19**: *Homo sapiens* prostate gland tissue male adult (37 years) and *Homo sapiens* epithelial cell of prostate (DNase-seq only)
* ```Skeletal_muscle```\
**hg38**:, *Homo sapiens* muscle of leg tissue female embryo (110 days), *Homo sapiens* muscle of leg tissue female embryo (115 days) (DNase-seq only), and *Homo sapiens* gastrocnemius medialis tissue male adult (37 years) (CTCF ChIP-seq only)\
**hg19**: *Homo sapiens* muscle of leg tissue female embryo (110 days), *Homo sapiens* muscle of leg tissue female embryo (115 days) (DNase-seq only), and *Homo sapiens* gastrocnemius medialis tissue male adult (37 years) (CTCF ChIP-seq only)
* ```Skin```\
**hg38**: *Homo sapiens* suprapubic skin tissue male adult (37 years) and *Homo sapiens* foreskin fibroblast male newborn (DNase-seq only)\
**hg19**: *Homo sapiens* suprapubic skin tissue male adult (37 years) and *Homo sapiens* foreskin fibroblast male newborn (DNase-seq only)
* ```Spleen```\
**hg38**: *Homo sapiens* spleen tissue male adult (37 years) and Homo sapiens spleen tissue embryo (112 days) (DNase-seq only)\
**hg19**: *Homo sapiens* spleen tissue male adult (37 years) and *Homo sapiens* spleen tissue embryo (112 days) (DNase-seq only)
* ```Stomach```\
**hg38**: Homo sapiens stomach tissue male adult (37 years) and Homo sapiens stomach tissue male adult (34 years) (DNase-seq only)\
**hg19**: *Homo sapiens* stomach tissue male adult (37 years) and *Homo sapiens* stomach tissue male adult (34 years) (DNase-seq only)
* ```Testis```\
**hg38**: *Homo sapiens* testis tissue male adult (37 years) and Homo sapiens testis tissue male adult (54 years) (DNase-seq only)\
**hg19**: *Homo sapiens* testis tissue male adult (37 years) and *Homo sapiens* testis tissue male adult (54 years) (DNase-seq only)
* ```Thyroid```\
**hg38**: *Homo sapiens* thyroid gland tissue female adult (51 years)\
**hg19**: *Homo sapiens* thyroid gland tissue female adult (51 years) and *Homo sapiens* thymus tissue female embryo (147 days) (DNase-seq only)
* ```Uterus```\
**hg38**: *Homo sapiens* uterus tissue female adult (51 years) and *Homo sapiens* uterus tissue female adult (53 years) (DNase-seq only)\
**hg19**: *Homo sapiens* uterus tissue female adult (51 years) and *Homo sapiens* HeLa-S3 (DNase-seq only)
* ```Vagina```\
**hg38**: *Homo sapiens* vagina tissue female adult (51 years)\
**hg19**: *Homo sapiens* vagina tissue female adult (51 years)\
\
In addition to these 28 provided tissue options, CoRE-BED also allows users to specify any other reference tissue of their choosing via the following additional tissue argument options:
* ```User_specified_file```\
Indicates that the user will provide their own H3K4me1, H3K4me3, H3K27ac, H3K27me3, and H3K36me3 histone ChIP-seq, as well as DNase-seq, reference file paths using the ```--user_4me1```, ```--user_4me3```, ```--user_27ac```, ```--user_27me3```, ```--user_36me3```, and ```--user_dnase``` arguments, respectively.
* ```User_specified_url```\
Indicates that the user will provide their own H3K4me1, H3K4me3, H3K27ac, H3K27me3, and H3K36me3 histone ChIP-seq, as well as DNase-seq, URLs of reference files to be downloaded using the ```--user_4me1```, ```--user_4me3```, ```--user_27ac```, ```--user_27me3```, ```--user_36me3```, and ```--user_dnase``` arguments, respectively.\

## CoRE-BED-training method script
In addition to ```core-bed_test.py```, we also provide ```core-bed_training.py```, which allows annotation using the more expansive training set of 827 reference epigenomes from EpiMap (Epigenome Integration across Multiple Annotation Projects).

The following is a comprehensive list of all available CoRE-BED Impute cell and tissue types organized by tissue category:
* ```Adipose```: adipose_adipocyte, adipose_34m, adipose_omental_fat_pad_51f, adipose_omental_fat_pad_53f, adipose_subcutaneous_25f, adipose_subcutaneous_41f, adipose_subcutaneous_49f, adipose_subcutaneous_59f, adipose_subcutaneous_81f
* ```Blood and T-cell```: blood_cd4_alpha_beta_memory_t_cell, blood_cd4_alpha_beta_memory_t_cell_blood_origin, blood_cd4_alpha_beta_t_cell, blood_cd4_alpha_beta_t_cell_33f, blood_cd4_alpha_beta_t_cell_21m, blood_cd4_alpha_beta_t_cell_37m, blood_cd4_alpha_beta_t_cell_phorbol, blood_cd4_cd25_alpha_beta_t_cell, blood_cd8_alpha_beta_memory_t_cell, blood_cd8_alpha_beta_t_cell, blood_cd8_alpha_beta_t_cell_33f, blood_cd8_alpha_beta_t_cell_34f, blood_cd8_alpha_beta_t_cell_21m, blood_cd8_alpha_beta_t_cell_28m, blood_cd8_alpha_beta_t_cell_37m, blood_effector_memory_cd4_alpha_beta_t_cell, blood_mononuclear_cell_male, blood_naive_thymus_cd4_alpha_beta_t_cell, blood_naive_thymus_cd4_alpha_beta_t_cell_35f, blood_naive_thymus_cd4_alpha_beta_t_cell_26m, blood_peripheral_mononuclear_cell_28f, blood_peripheral_mononuclear_cell_27m, blood_peripheral_mononuclear_cell_28m, blood_peripheral_mononuclear_cell_32m, blood_peripheral_mononuclear_cell_39m, blood_regulatory_t_cell_35f, blood_regulatory_t_cell_28m, blood_regulatory_t_cell_blood_origin, blood_t_cell, blood_t_cell_21m, blood_t_cell_36m, blood_t_cell_37m, blood_t1_helper_cell, blood_t1_helper_cell_26f, blood_t1_helper_cell_33m, blood_t17_helper_cell, blood_t17_helper_cell_blood_origin, blood_t17_helper_cell_phorbol, blood_t2_helper_cell_26f, blood_t2_helper_cell_33m
* ```Bone```: bone_arm, bone_femur, bone_marrow_stroma, bone_leg, bone_osteoblast
* ```Brain```: brain_ammons_horn_84m, brain_angular_gyrus_75f, brain_angular_gyrus_81m, brain_astrocyte, brain_astrocyte_cerebellum, brain_astrocyte_hippocampus, brain_astrocyte_spinal_cord, brain_embryo_112_days, brain_embryo_56_58_days, brain_embryo_80_days, brain_embryo_105_days_f, brain_embryo_109_days_f, brain_embryo_117_days_f, brain_embryo_120_days_f, brain_embryo_142_days_f, brain_embryo_17_weeks_f, brain_embryo_85_days_f, brain_embryo_96_days_f, brain_embryo_101_days_m, brain_embryo_104_days_m, brain_embryo_105_days_m, brain_embryo_122_days_m, brain_embryo_72_76_days_m, brain_caudate_nucleus_75f, brain_caudate_nucleus_78m, brain_caudate_nucleus_81m, brain_cerebellar_cortex_78_81m, brain_cerebellum_27_35m, brain_cerebellum_53m, brain_cingulate_gyrus_75f, brain_cingulate_gyrus_81m, brain_frontal_cortex_67_80f, brain_frontal_cortex_27_35m, brain_germinal_matrix_20_weeks_m, brain_globus_pallidus_78_84m, brain_inferior_parietal_cortex_84m, brain_hippocampus_75f, brain_hippocampus_73m, brain_medulla_oblongata_78_84m, brain_midbrain_78_84m, brain_middle_frontal_area_75f, brain_middle_frontal_area_81m, brain_middle_frontal_gyrus_78m, brain_occipital_lobe_84m, brain_pons_78m, brain_putamen_78m, brain_substantia_nigra_75f, brain_substantia_nigra_81m, brain_superior_temporal_gyrus_84m, brain_temporal_lobe_75f, brain_temporal_lobe_81m
* ```Cancer```: cancer_prostate_epithelial_22rv1, cancer_pancreas_adenocarcinoma_8988t, cancer_glioblastoma_a172, cancer_lung_epithelial_carcinoma_a549, cancer_lung_epithelial_carcinoma_a549_treated_ethanol_1hr, cancer_lung_epithelial_carcinoma_a549_treated_dexamethasone_1hr, cancer_lung_epithelial_carcinoma_a549_treated_dexamethasone_10hr, cancer_lung_epithelial_carcinoma_a549_treated_dexamethasone_10min, cancer_lung_epithelial_carcinoma_a549_treated_dexamethasone_12hr, cancer_lung_epithelial_carcinoma_a549_treated_dexamethasone_15min, cancer_lung_epithelial_carcinoma_a549_treated_dexamethasone_2hr, cancer_lung_epithelial_carcinoma_a549_treated_dexamethasone_20min, cancer_lung_epithelial_carcinoma_a549_treated_dexamethasone_25min, cancer_lung_epithelial_carcinoma_a549_treated_dexamethasone_3hr, cancer_lung_epithelial_carcinoma_a549_treated_dexamethasone_30min, cancer_lung_epithelial_carcinoma_a549_treated_dexamethasone_4hr, cancer_lung_epithelial_carcinoma_a549_treated_dexamethasone_5hr, cancer_lung_epithelial_carcinoma_a549_treated_dexamethasone_5min, cancer_lung_epithelial_carcinoma_a549_treated_dexamethasone_6hr, cancer_lung_epithelial_carcinoma_a549_treated_dexamethasone_7hr, cancer_lung_epithelial_carcinoma_a549_treated_dexamethasone_8hr, cancer_muscle_ewing_sarcoma_a673, cancer_adenoid_cystic_carcinoma_acc112, cancer_renal_cell_carcinoma_achn, cancer_neuroblastoma_be2c, cancer_prostate_c4-2b, cancer_colorectal_adenocarcinoma_caco-2, cancer_kidney_clear_cell_carcinoma_caki2, cancer_myelogenous_leukemia_cmk, cancer_melanoma_colo829, cancer_desmoplastic_medulloblastoma_daoy, cancer_acute_lymphoblastic_leukemia_dnd-41, cancer_b_cell_lymphoma_dohh2, cancer_kidney_rhaboid_tumor_g401, cancer_neuroglioma_h4, cancer_glioblastoma_h54, cancer_haploid_myelogenous_leukemia_hap-1, cancer_colorectal_adenocarcinoma_hct116, cancer_cervix_adenocarcinoma_hela-s3, cancer_cervix_adenocarcinoma_hela-s3_g1b_phase, cancer_cervix_adenocarcinoma_hela-s3_treated_interferon_alpha_4hr, cancer_hepatocellular_carcinoma_hepg2, cancer_acute_promyelocytic_leukemia_hl-60, cancer_colorectal_adenocarcinoma_ht-29, cancer_fibrosarcoma_ht1080, cancer_hepatocellular_carcinoma_huh-7.5, cancer_endometrial_adenocarcinoma_ishikawa_treated_dmso_1hr, cancer_endometrial_adenocarcinoma_ishikawa_treated_17b-estradiol_30min, cancer_endometrial_adenocarcinoma_ishikawa_treated_afimoxifene_30min, cancer_myelogenous_leukemia_k562, cancer_myelogenous_leukemia_k562_g1_phase, cancer_myelogenous_leukemia_k562_g2_phase, cancer_myelogenous_leukemia_k562_treated_dmso_72hr, cancer_myelogenous_leukemia_k562_treated_vorinostat_72hr, cancer_myelogenous_leukemia_k562_treated_sodium_butyrate_72hr, cancer_b_cell_lymphoma_karpas-422, cancer_myelogenous_leukemia_kbm-7, cancer_myeloma_kms-11, cancer_acute_lymphoblastic_leukemia_kopt-k1, cancer_prostate_adenocarcinoma_lncap_clone_fgc, cancer_prostate_adenocarcinoma_lncap_clone_fgc_treated_17b_12hr, cancer_acute_lymphoblastic_leukemia_loucy, cancer_colorectal_adenocarcinoma_lovo, cancer_glioblastoma_m059j, cancer_mammary_gland_adenocarcinoma_mcf-7, cancer_mammary_gland_adenocarcinoma_mcf-7_originated_from_mcf-7, cancer_mammary_gland_adenocarcinoma_mcf-7_treated_lactate_24hr, cancer_mammary_gland_adenocarcinoma_mcf-7_treated_estradiol_1hr, cancer_mammary_gland_adenocarcinoma_mcf-7_treated_ctcf_shrna_knockown, cancer_medulloblastoma, cancer_osteosarcoma_mg63, cancer_burkitt_lymphoma_namalwa, cancer_burkitt_lymphoma_namalwa_treated_sendai_virus_2hr, cancer_acute_promyelocytic_leukemia_nb4, cancer_squamous_cell_carcinoma_nci-h226, cancer_large_cell_lung_nci-h460, cancer_myeloma_nci-h929, cancer_testicular_embryonal_carcinoma_nt2_d1, cancer_b_cell_lymphoma_oci-ly1, cancer_b_cell_lymphoma_oci-ly3, cancer_b_cell_lymphoma_oci-ly7, cancer_pancreas_duct_epithelial_carcinoma_panc1, cancer_parathyroid_adenoma_62m, cancer_prostate_adenocarcinoma_pc-3, cancer_lung_adenocarcinoma_pc-9, cancer_renal_cell_adenocarcinoma_rcc_7860, cancer_renal_cell_carcinoma, cancer_colon_carcinoma_rko, cancer_melanoma_rpmi-7951, cancer_plasma_cell_myeloma_rpmi8226, cancer_rhabdomyosarcoma_sjcrh30, cancer_osteosarcoma_sjsa1, cancer_melanoma_sk-mel-5, cancer_neuroblastoma_sk-n-dz, cancer_neuroblastoma_sk-n-dz_treated_dmso_72hr, cancer_neuroepithelioma_sk-n-mc, cancer_neuroblastoma_sk-n-sh, cancer_neuroblastoma_sk-n-sh_treated_retinoic_acid_48hr, cancer_b_cell_lymphoma_su-dhl-6, cancer_colorectal_adenocarcinoma_sw480, cancer_mammary_gland_ductal_carcinoma_t47d, cancer_mammary_gland_ductal_carcinoma_t47d_treated_17b-estradiol_30min, cancer_prostate_epithelial_carcinoma_vcap, cancer_eye_retinoblastoma_weri-rb-1
* ```Digestive```: digestive_colon_mucosa_56f, digestive_colon_mucosa_73f, digestive_duodenum_mucosa_59m, digestive_duodenum_mucosa_76m, digestive_esophagus_30f, digestive_esophagus_34m, digestive_esophagus_muscularis_mucosa_53f, digestive_esophagus_muscularis_mucosa_37m, digestive_esophagus_squamous_epithelium_53f, digestive_esophagus_squamous_epithelium_37m, digestive_gastroesophageal_sphincter_53f, digestive_large_intestine_embryo_103_days_f, digestive_large_intestine_embryo_105_days_f, digestive_large_intestine_embryo_107_days_f, digestive_large_intestine_embryo_108_days_f, digestive_large_intestine_embryo_110_days_f, digestive_large_intestine_embryo_120_days_f, digestive_large_intestine_embryo_91_days_f, digestive_large_intestine_embryo_98_days_f, digestive_large_intestine_embryo_105_days_m, digestive_large_intestine_embryo_108_days_m, digestive_large_intestine_embryo_113_days_m, digestive_large_intestine_embryo_115_days_m, digestive_large_intestine_embryo_91_days_m, digestive_rectum_mucosa_50f, digestive_rectum_mucosa_61f, digestive_rectum_mucosa_59m, digestive_stomach_mucosa_59m, digestive_peyers_patch_53f, digestive_peyers_patch_37m, digestive_peyers_patch_54m, digestive_sigmoid_colon_51f, digestive_sigmoid_colon_53f, digestive_sigmoid_colon_34m, digestive_sigmoid_colon_54m, digestive_sigmoid_colon_3m, digestive_small_intestine_30f, digestive_small_intestine_105_days_f, digestive_small_intestine_107_days_f, digestive_small_intestine_108_days_f, digestive_small_intestine_110_days_f, digestive_small_intestine_120_days_f, digestive_small_intestine_91_days_f, digestive_small_intestine_98_days_f, digestive_small_intestine_34m, digestive_small_intestine_3m, digestive_small_intestine_105_days_m, digestive_small_intestine_108_days_m, digestive_small_intestine_115_days_m, digestive_small_intestine_87_days_m, digestive_small_intestine_91_days_m, digestive_stomach_101_days, digestive_stomach_30f, digestive_stomach_51f, digestive_stomach_53f, digestive_stomach_f, digestive_stomach_105_days_f, digestive_stomach_107_days_f, digestive_stomach_108_days_f, digestive_stomach_121_days_f, digestive_stomach_147_days_f, digestive_stomach_96_days_f, digestive_stomach_98_days_f, digestive_stomach_34m, digestive_stomach_54m, digestive_stomach_3m, digestive_stomach_108_days_m, digestive_stomach_127_days_m, digestive_stomach_58_76_days_m, digestive_stomach_91_days_m, digestive_transverse_colon_51f, digestive_transverse_colon_53f, digestive_transverse_colon_37m, digestive_transverse_colon_54m
* ```Endocrine```: endocrine_adrenal_gland_96_days, endocrine_adrenal_gland_30f, endocrine_adrenal_gland_51f, endocrine_adrenal_gland_53f, endocrine_adrenal_gland_108_days_f, endocrine_adrenal_gland_113_days_f, endocrine_adrenal_gland_85_days_f, endocrine_adrenal_gland_34m, endocrine_adrenal_gland_37m, endocrine_adrenal_gland_54m, endocrine_adrenal_gland_101_days_m, endocrine_adrenal_gland_108_days_m, endocrine_adrenal_gland_85_days_m, endocrine_adrenal_gland_97_days_m, endocrine_pancreas_59, endocrine_pancreas_m, endocrine_pancreas_45m, endocrine_pancreas_46m, endocrine_ovary_30f, endocrine_ovary_51f, endocrine_ovary_53f, endocrine_ovary_embryo_f, endocrine_testis_37m, endocrine_testis_54m, endocrine_testis_embryo_m, endocrine_thyroid_gland_51f, endocrine_thyroid_gland_53f, endocrine_thyroid_gland_37m, endocrine_thyroid_gland_54m
* ```Endothelial```: endothelial_brain_microvascular, endothelial_dermis_blood_vessel_adult_f, endothelial_dermis_blood_vessel_newborn_m, endothelial_dermis_microvascular_lymphatoc_vessel_f, endothelial_dermis_microvascular_lymphatoc_vessel_m, endothelial_umbilical_vein_newborn_m, endothelial_umbilical_vein_newborn, endothelial_glomerulus, endothelial_kidney_capillary_113_days_f, endothelial_lung_microvascular_f, endothelial_pulmonary_artery_f
* ```Epithelial```: epithelial_amnion, epithelial_bronchial, epithelial_bronchial_f_treated_retinoic_acid, epithelial_choroid_plexus, epithelial_colon, epithelial_esophagus, epithelial_prostate, epithelial_prostate_m, epithelial_proximal_tubule, epithelial_foreskin_keratinocyte_newborn_m, epithelial_foreskin_keratinocyte_newborn_2-4_days_m, epithelial_foreskin_keratinocyte_newborn_2-4_days_m_treated_calcium_2.5_days, epithelial_foreskin_keratinocyte_newborn_2-4_days_m_treated_calcium_5.5_days, epithelial_glomerulus_visceral_3, epithelial_proximal_tubule_hk-2, epithelial_pancreatic_duct_dpde6-e6e7, epithelial_bone_marrow_hs-27a, epithelial_iris_pigment, epithelial_keratinocyte_f, epithelial_keratinocyte_m, epithelial_kidney, epithelial_glomerulus_43_62_m, epithelial_tubule_80f_62m, epithelial_tubule_80f_treated_cisplatin, epithelial_skin_leg_53f, epithelial_skin_leg_37m, epithelial_mammary_luminal_33f, epithelial_mammary_f, epithelial_mammary_18f, epithelial_mammary_50f, epithelial_breast_mcf_10a, epithelial_breast_mcf_10a_treated_tamoxifen_24hr, epithelial_breast_mcf_10a_treated_tamoxifen_6hr, epithelial_mammary_myoepithelial_33f, epithelial_mammary_myoepithelial_36f, epithelial_non-pigmented_ciliary, epithelial_renal_cortical, epithelial_retinal, epithelial_prostate_rwpe1, epithelial_prostate_rwpe2, epithelial_skin_of_body_82_days_f
* ```ES-deriv```: esc_deriv_bipolar_neuron_gm23338_origin_treated_doxycycline_4_days, esc_deriv_cardiac_mesoderm_h7-hesc_origin, esc_deriv_cardiac_muscle_rues2_origin, esc_deriv_neural_progenitor_h9_origin_1, esc_deriv_ectodermal, esc_deriv_endodermal, esc_deriv_endodermal_hues64_origin, esc_deriv_hepatocyte_h9_origin, esc_deriv_mesenchymal_stem_h1-hesc_origin, esc_deriv_mesendoderm_h1-hesc_origin, esc_deriv_mesodermal_hues64_origin, esc_deriv_neural_crest_h1-hesc_origin, esc_deriv_neural_progenitor_h9_origin_2, esc_deriv_neural_progenitor_h1-hesc_origin, esc_deriv_neural_progenitor_h9_origin_3, esc_deriv_neuron_h9_origin, esc_deriv_smooth_muscle_h9_origin, esc_deriv_trophoblast_h1-hesc_origin
* ```ESC```: esc_elf-1, esc_es-i3, esc_h1-hesc, esc_h7-hesc, esc_h9, esc_hues48, esc_hues6, esc_hues64, esc_ucsf-4
* ```Eye```: eye_56_days_76_days_m, eye_76_days_f, eye_125_days_103_days_m, eye_74_days_85_days, eye_89_days_f
* ```Heart```: heart_aorta_30f, heart_aorta_34m, heart_ascending_aorta_51f, heart_ascending_aorta_53f, heart_coronary_artery_51f, heart_coronary_artery_53f, heart_101_days, heart_59_days_76_days_f, heart_80_days, heart_96_days, heart_103_days_f, heart_105_days_f, heart_110_days_f, heart_116_days_98_days_f, heart_116_days_117_days_f, heart_147_days_f, heart_91_days_f, heart_left_ventricle_53f, heart_left_ventricle_101_days_103_days_f, heart_left_ventricle_136_days_f, heart_left_ventricle_34m, heart_left_ventricle_3m, heart_27m_35m, heart_3m, heart_105_days_m, heart_110_days_m, heart_120_days_m, heart_72_days_76_days_m, heart_91_days_m, heart_96_days_m, heart_right_ventricle_101_days_103_days_f, heart_right_ventricle_34m, heart_right_ventricle_3m, heart_left_atrium_101_days_f, heart_right_atrium_51f, heart_right_atrium_53f, heart_right_atrium_34m, heart_thoracic_aorta_37m, heart_thoracic_aorta_54m, heart_tibial_artery_53f, heart_tibial_artery_37m
* ```HSC and B-cell```: hsc_and_b_cell_b_cell, hsc_and_b_cell_b_cell_27f, hsc_and_b_cell_b_cell_27f_43f, hsc_and_b_cell_b_cell_34f, hsc_and_b_cell_b_cell_43f, hsc_and_b_cell_b_cell_21m, hsc_and_b_cell_b_cell_37m, hsc_and_b_cell_cd14_monocyte_f, hsc_and_b_cell_cd14_monocyte_34f, hsc_and_b_cell_cd14_monocyte_21m, hsc_and_b_cell_cd14_monocyte_37m, hsc_and_b_cell_cd1c_myeloid_dendritic, hsc_and_b_cell_cmp_cd34, hsc_and_b_cell_cmp_cd34_f, hsc_and_b_cell_cmp_cd34_27f, hsc_and_b_cell_cmp_cd34_33f, hsc_and_b_cell_cmp_cd34_50f, hsc_and_b_cell_cmp_cd34_m, hsc_and_b_cell_cmp_cd34_adult_m, hsc_and_b_cell_cmp_cd34_23m, hsc_and_b_cell_cmp_cd34_36m, hsc_and_b_cell_cmp_cd34_37m, hsc_and_b_cell_cmp_cd34_42m, hsc_and_b_cell_cmp_cd34_43m, hsc_and_b_cell_cmp_cd34_49m, hsc_and_b_cell_germinal_center, hsc_and_b_cell_mpp, hsc_and_b_cell_mpp_25m_treated_erythropoietin_hydrocortisone_succinate_ligand_il3_20_days, hsc_and_b_cell_mpp_25m_treated_erythropoietin_hydrocortisone_succinate_ligand_il3_11_days, hsc_and_b_cell_mpp_25m_treated_erythropoietin_hydrocortisone_succinate_ligand_il3_13_days, hsc_and_b_cell_mpp_25m_treated_erythropoietin_hydrocortisone_succinate_ligand_il3_15_days, hsc_and_b_cell_mpp_25m_treated_erythropoietin_hydrocortisone_succinate_ligand_il3_17_days, hsc_and_b_cell_mpp_25m_treated_erythropoietin_hydrocortisone_succinate_ligand_il3_18_days, hsc_and_b_cell_mpp_25m_treated_erythropoietin_hydrocortisone_succinate_ligand_il3_4_days, hsc_and_b_cell_mpp_25m_treated_erythropoietin_hydrocortisone_succinate_ligand_il3_6_days, hsc_and_b_cell_mpp_25m_treated_erythropoietin_hydrocortisone_succinate_ligand_il3_8_days, hsc_and_b_cell_lymphocyte_jurkat_clone_e61, hsc_and_b_cell_lymphocyte_naive_b_cell, hsc_and_b_cell_nk_34f, hsc_and_b_cell_nk_21m, hsc_and_b_cell_nk_37m, hsc_and_b_cell_neutrophil, hsc_and_b_cell_neutrophil_m
* ```iPSC```: ipsc_cwru1_m, ipsc_gm23338_53m_gm23248_origin, ipsc_ips_df_19.11_newborn_m, ipsc_ips_df_19.7_newborn_m, ipsc_ips_df_14.7_newborn_m, ipsc_ips_df_6.9_newborn_m, ipsc_ips-11a_36m, ipsc_ips-15b_48f, ipsc_ips-18a_48f, ipsc_ips-18c_48f, ipsc_ips-20b_55m, ipsc_ips-nihi11_71m_ag20443_origin, ipsc_ips-nihi7_85f_ag08395_origin, ipsc_l1-s8, ipsc_l1-s8r
* ```Kidney```: kidney_hek293, kidney_hek293t, kidney_59_days_59_days_f, kidney_80_days, kidney_105_days_f, kidney_108_days_f, kidney_113_days_f, kidney_120_days_f, kidney_121_days_f, kidney_76_days_f_76_days_m, kidney_85_days_f, kidney_50m, kidney_67m, kidney_105_days_m, kidney_85_days_m, kidney_87_days_m, kidney_left_107_days_f, kidney_left_110_days_f, kidney_left_147_days_f, kidney_left_59_days_f_91_days_m, kidney_left_87_days_f, kidney_left_89_days_f, kidney_left_115_days_m, kidney_left_87_days_m, kidney_left_96_days_m, kidney_left_renal_cortex_interstitium_105_days_m, kidney_left_renal_cortex_interstitium_120_days_m, kidney_left_renal_pelvis_105_days_m, kidney_left_renal_pelvis_120_days_m, kidney_renal_cortex_interstitium_103_days_f, kidney_renal_cortex_interstitium_120_days_f, kidney_renal_cortex_interstitium_89_days_f, kidney_renal_cortex_interstitium_96_days_f, kidney_renal_cortex_interstitium_108_days_m, kidney_renal_cortex_interstitium_113_days_m, kidney_renal_cortex_interstitium_127_days_m, kidney_renal_cortex_interstitium_91_days_m, kidney_renal_cortex_interstitium_97_days_m, kidney_renal_pelvis_103_days_f, kidney_renal_pelvis_105_days_f, kidney_renal_pelvis_89_days_f, kidney_renal_pelvis_96_days_f, kidney_renal_pelvis_108_days_m, kidney_renal_pelvis_113_days_m, kidney_renal_pelvis_127_days_m, kidney_renal_pelvis_91_days_m, kidney_renal_pelvis_97_days_m, kidney_right_107_days_f, kidney_right_117_days_f, kidney_right_147_days_f, kidney_right_87_days_f, kidney_right_98_days_f, kidney_right_108_days_m, kidney_right_115_days_m, kidney_right_87_days_m, kidney_right_91_days_m, kidney_right_96_days_m, kidney_right_renal_cortex_interstitium_105_days_m, kidney_right_renal_cortex_interstitium_120_days_m, kidney_right_renal_pelvis_105_days_m, kidney_right_renal_pelvis_120_days_m
* ```Liver```: liver_hepatic_stellate_cell_59f, liver_hepatocyte, liver_59_days_80_days, liver_25f, liver_101_days_113_days_f, liver_31m, liver_32m, liver_78m, liver_right_lobe_53f
* ```Lung```: lung_left_105_days_f, lung_left_107_days_f, lung_left_108_days_f, lung_left_110_days_f, lung_left_117_days_f, lung_left_91_days_f, lung_left_98_days_f, lung_left_105_days_m, lung_left_113_days_m, lung_left_115_days_m, lung_left_87_days_m, lung_left_91_days_m, lung_left_96_days_m, lung_101_days, lung_112_days, lung_67_days, lung_80_days_76_days_m, lung_30f, lung_108_days_f, lung_120_days_f, lung_76_days_f, lung_82_days_f, lung_85_days_f, lung_96_days_f, lung_3m, lung_103_days_m, lung_108_days_m, lung_54_days_58_days_m, lung_82_days_m, lung_right_105_days_f, lung_right_107_days_f, lung_right_108_days_f, lung_right_110_days_f, lung_right_117_days_f, lung_right_91_days_f, lung_right_98_days_f, lung_right_105_days_m, lung_right_115_days_m, lung_right_87_days_m, lung_right_96_days_m, lung_left_upper_lobe_51f, lung_left_upper_lobe_53f, lung_left_upper_lobe_37m
* ```Lymphoblastoid```: lymphoblastoid_gm06990, lymphoblastoid_gm08714, lymphoblastoid_gm10248, lymphoblastoid_gm10266, lymphoblastoid_gm12864, lymphoblastoid_gm12865, lymphoblastoid_gm12875, lymphoblastoid_gm12878, lymphoblastoid_gm12891, lymphoblastoid_gm12892, lymphoblastoid_gm18507, lymphoblastoid_gm19238, lymphoblastoid_gm19239, lymphoblastoid_gm19240
* ```Mesench```: mesench_adipocyte_msc_origin, mesench_msc_dedifferentiated_amniotic_fluid_origin, mesench_embryonic_facial_prominence_53_days_58_days, mesench_msc_adipose_origin
* ```Muscle```: muscle_cardiac_myocyte, muscle_forelimb_108_days_f, muscle_gastrocnemius_medialis_51f, muscle_gastrocnemius_medialis_53f, muscle_gastrocnemius_medialis_37m, muscle_gastrocnemius_medialis_54m, muscle_leg_hindlimb_120_days_m, muscle_arm_101_days, muscle_arm_105_days_f, muscle_arm_115_days_f, muscle_arm_120_days_f, muscle_arm_85_days_f, muscle_arm_98_days_f, muscle_arm_101_days_m, muscle_arm_104_days_m, muscle_arm_105_days_m, muscle_arm_113_days_m, muscle_arm_115_days_m, muscle_arm_120_days_m, muscle_arm_127_days_m, muscle_arm_96_days_m, muscle_arm_97_days_m, muscle_back_105_days_f, muscle_back_113_days_f, muscle_back_115_days_f, muscle_back_85_days_f, muscle_back_98_days_f, muscle_back_101_days_m, muscle_back_104_days_m, muscle_back_105_days_m, muscle_back_108_days_m, muscle_back_127_days_m, muscle_back_91_days_m, muscle_back_96_days_m, muscle_back_97_days_m, muscle_leg_105_days_f, muscle_leg_110_days_f, muscle_leg_113_days_f, muscle_leg_115_days_f, muscle_leg_85_days_f, muscle_leg_101_days_m, muscle_leg_104_days_m, muscle_leg_105_days_m, muscle_leg_115_days_m, muscle_leg_127_days_m, muscle_leg_96_days_m, muscle_leg_97_days_m, muscle_trunk_113_days_f, muscle_trunk_115_days_f, muscle_trunk_120_days_f, muscle_trunk_121_days_f, muscle_psoas_30f, muscle_psoas_27m_35m, muscle_psoas_34m, muscle_psoas_3m, muscle_skeletal_cell, muscle_skeletal_tissue, muscle_skeletal_tissue_72f, muscle_skeletal_tissue_54m, muscle_tongue_59_days_f_76_days_f, muscle_tongue_72_days_m
* ```Myosat```: "myosat_skeletal_muscle_myoblast_lhcn-m2", "myosat_myocyte_lhcn-m2_origin", "myosat_myotube_skeletal_muscle_myoblast_origin", "myosat_skeletal_muscle_myoblast", "myosat_skeletal_muscle_myoblast_22m", "myosat_skeletal_muscle_satellite_cell_mesoderm_origin_f"
* ```Neurosph```: neurosph_15_weeks_ganglionic_eminence_origin, neurosph_17_weeks_f_ganglionic_cortex_origin, neurosph_17_weeks_f_ganglionic_eminence_origin, neurosph_olfactory_cell_line]
other_array = [other_breast_epithelium_51f, other_breast_epithelium_53f, other_epidermal_melanocyte, other_foreskin_melanocyte_newborn_m, other_limb_embryo_53_days_56_days, other_limb_embryo_58_days_59_days, other_mammary_stem_cell
* ```Pancreas```: pancreas_body_51f, pancreas_body_53f, pancreas_body_37m, pancreas_body_54m, pancreas_islet_precursor_cell, pancreas_30f, pancreas_34m
* ```Placenta and EMM```: placenta_and_eem_amnion_16_weeks_m, placenta_and_eem_amnion_stem_cell, placenta_and_eem_chorion, placenta_and_eem_chorion_40_weeks_f, placenta_and_eem_chorion_16_weeks_m, placenta_and_eem_chorionic_villus_16_weeks, placenta_and_eem_chorionic_villus_40_weeks_f, placenta_and_eem_chorionic_villus_16_weeks_m, placenta_and_eem_chorionic_villus_38_weeks_m, placenta_and_eem_trophoblast_htr-8_svneo, placenta_and_eem_placenta_102_days, placenta_and_eem_placenta_16_weeks, placenta_and_eem_placenta_53_days, placenta_and_eem_placenta_56_days_59_days, placenta_and_eem_placenta_101_days_f_105_days_m, placenta_and_eem_placenta_105_days_f, placenta_and_eem_placenta_108_days_f, placenta_and_eem_placenta_113_days_f, placenta_and_eem_placenta_85_days_f, placenta_and_eem_placenta_16_weeks_m, placenta_and_eem_placenta_85_days_m, placenta_and_eem_placenta_91_days_m, placenta_and_eem_placental_basal_plate_40_weeks_f, placenta_and_eem_placental_basal_plate_38_weeks_m, placenta_and_eem_trophoblast_cell_17_weeks_18_weeks, placenta_and_eem_trophoblast_cell_21_weeks, placenta_and_eem_trophoblast_cell_23_weeks, placenta_and_eem_trophoblast_cell_39_weeks_40_weeks, placenta_and_eem_trophoblast_20_weeks_f, placenta_and_eem_trophoblast_40_weeks_f, placenta_and_eem_umbilical_cord_59_days_76_days_m
* ```PNS```: pns_spinal_cord_108_days_f, pns_spinal_cord_113_days_f, pns_spinal_cord_59_days_f_72_days_m, pns_spinal_cord_87_days_f, pns_spinal_cord_89_days_f, pns_spinal_cord_105_days_m, pns_spinal_cord_96_days_m, pns_tibial_nerve_51f, pns_tibial_nerve_53f, pns_tibial_nerve_37m
* ```Reproductive```: reproductive_prostate_gland_37m, reproductive_prostate_gland_54m, reproductive_uterus_53f, reproductive_vagina_51f, reproductive_vagina_53f
* ```Sm. Muscle```: sm_muscle_colon_56f, sm_muscle_colon_77f, sm_muscle_duodenum_59m, sm_muscle_duodenum_73m, sm_muscle_rectum_50f, sm_muscle_brain_vasculature_smooth_cell, sm_muscle_stomach_84f, sm_muscle_stomach_59m
* ```Spleen```: spleen_112_days, spleen_30f, spleen_53f, spleen_34m, spleen_54m, spleen_3m
* ```Stromal```: stromal_skin_fibroblast_ag04449, stromal_lung_fibroblast_ag04450, stromal_skin_fibroblast_ag08395, stromal_lung_fibroblast_ag08396, stromal_skin_fibroblast_ag08396, stromal_gingival_fibroblast_ag09319, stromal_skin_fibroblast_ag10803, stromal_skin_fibroblast_ag20443, stromal_skin_fibroblast_bj, stromal_brain_pericyte, stromal_cardiac_fibroblast, stromal_cardiac_fibroblast_f, stromal_cardiac_fibroblast_94_days_f_98_days_f, stromal_skin_fibroblast_eh, stromal_skin_fibroblast_el, stromal_skin_fibroblast_elr, stromal_breast_fibroblast_17f, stromal_breast_fibroblast_26f, stromal_dermis_fibroblast, stromal_dermis_fibroblast_f, stromal_dermis_fibroblast_none_f, stromal_gingival_fibroblast, stromal_lung_fibroblast, stromal_lung_fibroblast_11f_45m, stromal_lung_fibroblast_45m, stromal_mammary_fibroblast_f, stromal_peridontal_ligament_fibroblast_m, stromal_pulmonary_artery_fibroblast, stromal_skin_fibroblast_abdomen_97_days_m, stromal_aorta_fibroblast_f, stromal_conjunctiva_fibroblast, stromal_villous_mesenchyme_fibroblast, stromal_foreskin_fibroblast_newborn_m, stromal_skin_fibroblast_gm03348, stromal_skin_fibroblast_gm04503, stromal_skin_fibroblast_gm04504, stromal_skin_fibroblast_gm23248, stromal_foreskin_fibroblast_hff-myc_foreskin_fibroblast_origin, stromal_lung_fibroblast_imr-90, stromal_lung_fibroblast_97_days_m, stromal_bone_marrow_m, stromal_lung_fibroblast_wi38
* ```Thymus```: thymus_embryo_f, thymus_105_days_f, thymus_110_days_f, thymus_113_days_f, thymus_147_days_f, thymus_98_days_f, thymus_3m, thymus_104_days_m, thymus_108_days_m, thymus_113_days_m, thymus_127_days_m
* ```Urinary```: urinary_bladder_34m, urinary_bladder_76_days_m, urinary_urothelium_cell_line

## Underlying decision tree classification
Upon preparation of all reference files, the BED containing transcription start sites (TSSs) is modified by subtracting 5 kb from each start coordinate and adding 1 kb to each end coordinate. These TSS distances can also be customized by the user. The script then uses the modified TSS coordinates to determine whether each input coordinate overlaps with a genomic interval within these coordinate boundaries. Those input coordinates that do have overlap are considered "candidate promoters" and those that do not are considered "candidate enhancers."

For the set of candidate promoters, the script next determines whether each coordinate overlaps with the H3K4me3, a histone modification commonly associated with promoter regions in active chromatin. Those that do overlap with H3K4me3 are subsequently evaluated for overlap with H3K27me3, a repressive histone mark. If a coordinate has both H3K4me3 and H3K27me3, it is classified as a "bivalent promoter," meaning that while not presently active, it is "poised" to become either active or more permanently repressed by losing one of the two histone marks. If no H3K27me3 is present, then the element is classified as an "active promoter."

Conversely, coordinates that do not have any overlap with H3K4me3 are next evaluated for overlap with H3K27me3. Elements that are marked with only H3K27me3 are classified as "silenced promoters." For those coordinates that do not overlap with either H3K4me3 or H3K27me3, overlap with H3K36me3, a histone mark associated with gene bodies, as well as with DNase I hypersensitive (DHS) sites (assayed using DNase-seq) is next assessed. Regions overlapping with both H3K36me3 and DHS sites are classified as "unclassified active chromatin; gene_body; within_2kb_of_tss," those overlapping with H3K36me3 but not DHS sites are classified as "unclassified inactive chromatin; gene_body; within_2kb_of_tss," regions that harbor no H3K36me3 but do overlap with a DHS site are termed "unclassified active chromatin within_2kb_of_tss," and those with neither of the two marks are classified as "unclassified inactive chromatin within_2kb_of_tss."

With our set of candidate enhancers, CoRE-BED will search for overlap with three enhancer-associated histone marks, H3K4me1, H3K27ac, and H3K27me3. The script first determines whether there is any overlap with H3K4me1, a mark commonly used to denote the presence of an enhancer. If H3K4me1 is present, then we next search for co-localization of the active mark H3K27ac. If both marks localize at a single element, then we classify this as an "active enhancer." Otherwise, CoRE-BED will search for overlap with the repressive mark H3K27me3. Elements that show a co-localization of H3K4me1 and H3K27me3 will be classified as "poised enhancers," while those marked with only H3K4me1 are classified as "primed enhancers." 

The remaining coordinates that do not have any overlap with H3K4me1, H3K27ac, or H3K27me3 are assessed for overlap with H3K36me3 and DHS sites, in the same way that the unclassified candidate promoter regions were. Coordinates that overlap both H3K36me3 and DHS sites are classified as "unclassified active chromatin; gene_body; beyond_2kb_of_tss," those overlapping with H3K36me3 but not DHS sites are classified as "unclassified inactive chromatin; gene_body; beyond_2kb_of_tss," regions that harbor no H3K36me3 but do overlap with a DHS site are termed "unclassified active chromatin beyond_2kb_of_tss," and those with neither of the two marks are classified as "unclassified inactive chromatin beyond_2kb_of_tss." The main output consists of the original input, along with additional functional annotation columns appended for each of the tissues for which a CoRE-BED annotation was run. A separate .txt file summarizing the number of input coordinates falling into each of these described catagories is also written out along with the main output file.

## Dependencies
All dependencies (including ```python``` (3.6), ```requests```, ```pybedtools```, ```pandas```, ```tabix```, ```ucsc-bigwigmerge```, ```ucsc-bigwigtobedgraph```, and ```MACS2```) can be easily installed as an Anaconda environment using the included ```core-bed_env.yml``` file:
```
conda env create -f core-bed_env.yml
```
...and then activated using the following command:
```
conda activate core-bed_env
```

## Usage
Use the ```-h``` or ```--help``` flag to view all available options:
```
python core-bed_test.py -h

usage: core-bed.py [-h] -i INPUT -g REF_GENOME -t TISSUE
                   [-ud TSS_DISTANCE_UPSTREAM] [-dd TSS_DISTANCE_DOWNSTREAM]
                   [-o OUTPUT] [-r REF_DIR] [--no_multianno]
                   [--bed_cols BED_COLS] [--input_header]
                   [--user_4me1 USER_4ME1] [--user_4me3 USER_4ME3]
                   [--user_27ac USER_27AC] [--user_27me3 USER_27ME3]
                   [--user_ctcf USER_CTCF] [--user_dnase USER_DNASE]
                   [--user_tissue_names USER_TISSUE_NAMES] [-v]

optional arguments:
  -h, --help            show this help message and exit
  -i INPUT, --input INPUT
                        the input bed file (required)
  -g REF_GENOME, --ref_genome REF_GENOME
                        the human or mouse reference genome build on which the
                        input coordinates are based (required) (valid options:
                        GRCh38/hg38, GRCh37/hg19, GRCm39/mm39, GRCm38/mm10, or
                        GRCm37/mm9)
  -t TISSUE, --tissue TISSUE
                        the tissue of interest (required) (valid human
                        options: Adipose, Adrenal_gland, Artery, Blood,
                        Breast, Cultured_fibroblast,
                        EBV_transformed_lymphocyte, ES,
                        Esophagus_muscularis_mucosa,
                        Esophagus_squamous_epithelium, Heart, Intestine, iPS,
                        Kidney, Liver, Lung, Neuron, Ovary, Pancreas,
                        Prostate, Skeletal_muscle, Skin, Spleen, Stomach,
                        Testis, Thyroid, Uterus, Vagina, All,
                        User_provided_files, User_provided_urls; valid mouse
                        options: User_provided_files, User_provided_urls)
  -ud TSS_DISTANCE_UPSTREAM, --tss_distance_upstream TSS_DISTANCE_UPSTREAM
                        the upstream boundary distance from a TSS (default:
                        5000 bp)
  -dd TSS_DISTANCE_DOWNSTREAM, --tss_distance_downstream TSS_DISTANCE_DOWNSTREAM
                        the downstream boundary distance from a TSS (default:
                        1000 bp)
  -o OUTPUT, --output OUTPUT
                        the name of the output file
  -r REF_DIR, --ref_dir REF_DIR
                        the path of the reference file directory
  --no_multianno        if a coordinate overlaps with multiple regions, keep
                        the most significant occurance
  --bed_cols BED_COLS   if the input is not in traditional UCSC BED format,
                        specify the column numbers of chr, start, and end
                        separated by commas
  --input_header        use if the input file has a header
  --user_4me1 USER_4ME1
                        if the User_provided_files or User_provided_urls
                        tissue option is specified, specify either the path or
                        URL of the user-provided H3K4me1 ChIP-seq peaks
  --user_4me3 USER_4ME3
                        if the User_provided_files or User_provided_urls
                        tissue option is specified, specify either the path or
                        URL of the user-provided H3K4me3 ChIP-seq peaks
  --user_27ac USER_27AC
                        if the User_provided_files or User_provided_urls
                        tissue option is specified, specify either the path or
                        URL of the user-provided H3K27ac ChIP-seq peaks
  --user_27me3 USER_27ME3
                        if the User_provided_files or User_provided_urls
                        tissue option is specified, specify either the path or
                        URL of the user-provided H3K27me3 ChIP-seq peaks
  --user_ctcf USER_CTCF
                        if the User_provided_files or User_provided_urls
                        tissue option is specified, specify either the path or
                        URL of the user-provided CTCF ChIP-seq peaks
  --user_dnase USER_DNASE
                        if the User_provided_files or User_provided_urls
                        tissue option is specified, specify either the path or
                        URL of the user-provided DNase-seq peaks
  --user_tissue_names USER_TISSUE_NAMES
                        if the User_provided_files or User_provided_urls
                        tissue option is specified, specify the names of each
                        corresponding tissue type
  -v, --verbose         return logging as terminal output
```

A run of the CoRE-BED method to annotate a set of GWAS summary statistics in a single tissue type would look something like the following:
```
python core-bed_test.py \
-i input_gwas_summary_stats_based_on_hg38.txt \
-g hg38 \
-t blood \
-o annotated_input_gwas_summary_stats_based_on_hg38.txt \
-v \
--no_multianno \
--bed_cols 3,4,4 \
--input_header
```
...with each of the user-specified arguments specifying:
* ```-i``` or ```--input```\
A set of genomic coordinates in UCSC BED format (https://genome.ucsc.edu/FAQ/FAQformat.html)
* ```-g``` or ```--ref_genome```\
The reference genome build on which the input coordinates are based
* ```-t``` or ```--tissue```\
The tissue type to which the input coordinates will be compared
* ```-o``` or ```--output```\
The desired name of the output file (default is ```out.bed```)
* ```-v``` or ```--verbose```\
Enable verbosity (i.e. print the script progress out to the console)
* ```--no_multianno```\
If a coordinate overlaps with multiple regions, keep the most significant occurance (i.e. If a coordinate overlaps with both an active promoter and unclassified inactive chromatin region within 5 kb upstream and 1 kb downstream of a TSS, only the active promoter will be retained in the final annotation set.)
* ```--bed_cols```\
The columns of the input file (1-indexed) containing the chr, start coordinate, and end coordinate. For files containing only a single variant coordinate (common for GWAS summary statistics), specify this same column for both the start and end coordinate.
* ```--input_header```\
Specifies that the input file does have a header\
\
The final output file will retain all of the columns of the original input, with a newly appended column of CoRE-BED functional annotations.\
\
Initiating a single run of the CoRE-BED method to annotate GWAS summary statistics in multiple tissue types simultaneously (using both pre-specified options and user-specified reference files) would look like the following example:
```
python core-bed_test.py \
-i input_gwas_summary_stats_based_on_hg38.txt \
-g hg38 \
-t ebv_transformed_lymphocyte,User_provided_urls \
--user_4me1 https://www.encodeproject.org/files/ENCFF918LCT/@@download/ENCFF918LCT.bed.gz \
--user_4me3 https://www.encodeproject.org/files/ENCFF348NMZ/@@download/ENCFF348NMZ.bed.gz \
--user_27ac https://www.encodeproject.org/files/ENCFF647VWE/@@download/ENCFF647VWE.bed.gz \
--user_27me3 https://www.encodeproject.org/files/ENCFF601KLF/@@download/ENCFF601KLF.bed.gz \
--user_ctcf https://www.encodeproject.org/files/ENCFF961DXJ/@@download/ENCFF961DXJ.bed.gz \
--user_dnase https://www.encodeproject.org/files/ENCFF213LJI/@@download/ENCFF213LJI.bed.gz \
--user_tissue_names alpha_beta_regulatory_t_cell \
--no_multianno \
--input_header \
--bed_cols 12,13,13 \
-o Immune_multianno_2000_2000_gwas-association-downloaded_2021-06-09-EFO_0000783-withChildTraits_reg_anno.tsv \
-v
```
...with each of the user-specified arguments specifying:
* ```-i``` or ```--input```\
A set of genomic coordinates in UCSC BED format (https://genome.ucsc.edu/FAQ/FAQformat.html)
* ```-g``` or ```--ref_genome```\
The reference genome build on which the input coordinates are based
* ```-t``` or ```--tissue```\
The tissue types to which the input coordinates will be compared. All included CoRE-BED tissues can be specified by name. User-specified files should be denoted by the ```user_provided_files``` label, and user-specified URLs to be downloaded by CoRE-BED should be denoted using the ```user_provided_urls``` label. Multiple entries should be separated by a comma.
* ```--user_4me1```\
Either the file paths (when ```--tissue``` is ```user_provided_files```) or the URLs (when ```--tissue``` is ```user_provided_urls```) of the H3K4me1 histone ChIP-seq reference files. Multiple entries should be separated by a comma and should be listed in the same order as the ```user_provided_files``` and ```user_provided_urls``` options under ```--tissue```.
* ```--user_4me3```\
Either the file paths (when ```--tissue``` is ```user_provided_files```) or the URLs (when ```--tissue``` is ```user_provided_urls```) of the H3K4me3 histone ChIP-seq reference files. Multiple entries should be separated by a comma and should be listed in the same order as the ```user_provided_files``` and ```user_provided_urls``` options under ```--tissue```.
* ```--user_27ac```\
Either the file paths (when ```--tissue``` is ```user_provided_files```) or the URLs (when ```--tissue``` is ```user_provided_urls```) of the H3K27ac histone ChIP-seq reference files. Multiple entries should be separated by a comma and should be listed in the same order as the ```user_provided_files``` and ```user_provided_urls``` options under ```--tissue```.
* ```--user_27me3```\
Either the file paths (when ```--tissue``` is ```user_provided_files```) or the URLs (when ```--tissue``` is ```user_provided_urls```) of the H3K27me3 histone ChIP-seq reference files. Multiple entries should be separated by a comma and should be listed in the same order as the ```user_provided_files``` and ```user_provided_urls``` options under ```--tissue```.
* ```--user_ctcf```\
Either the file paths (when ```--tissue``` is ```user_provided_files```) or the URLs (when ```--tissue``` is ```user_provided_urls```) of the CTCF TF ChIP-seq reference files. Multiple entries should be separated by a comma and should be listed in the same order as the ```user_provided_files``` and ```user_provided_urls``` options under ```--tissue```.
* ```--user_dnase```\
Either the file paths (when ```--tissue``` is ```user_provided_files```) or the URLs (when ```--tissue``` is ```user_provided_urls```) of the DNase-seq reference files. Multiple entries should be separated by a comma and should be listed in the same order as the ```user_provided_files``` and ```user_provided_urls``` options under ```--tissue```.
* ```--user_tissue_names```\
The name by which each of the user-input files or URLs should be referred to, i.e. the cell/tissue type. Multiple entries should be separated by a comma and should be listed in the same order as the ```user_provided_files``` and ```user_provided_urls``` options under ```--tissue```.
* ```-o``` or ```--output```\
The desired name of the output file (default is ```out.bed```)
* ```-v``` or ```--verbose```\
Enable verbosity (i.e. print the script progress out to the console)
* ```--no_multianno```\
If a coordinate overlaps with multiple regions, keep the most significant occurance (i.e. If a coordinate overlaps with both an active promoter and unclassified inactive chromatin region within 5 kb upstream and 1 kb downstream of a TSS, only the active promoter will be retained in the final annotation set.)
* ```--bed_cols```\
The columns of the input file (1-indexed) containing the chr, start coordinate, and end coordinate. For files containing only a single variant coordinate (common for GWAS summary statistics), specify this same column for both the start and end coordinate.
* ```--input_header```\
Specifies that the input file does have a header\
\
The final output file will retain all of the columns of the original input, with a newly appended column of CoRE-BED functional annotations.\

## Genome-wide regulatory element sets
UCSC BED files with genome-wide promoter and enhancer annotations across all 28 CoRE-BED  tissue types are available in the ```genome-wide_reg_elements``` directory.

## References
1.	Pennacchio, L. A., Bickmore, W., Dean, A., Nobrega, M. A. & Bejerano, G. Enhancers: five essential questions. Nat. Rev. Genet. 14, 288–295 (2013).
2.	Sha, K. & Boyer, L. A. The chromatin signature of pluripotent cells. in StemBook (Harvard Stem Cell Institute, 2009).
3.	Mas, G. et al. Promoter bivalency favors an open chromatin architecture in embryonic stem cells. Nat. Genet. 50, 1452–1462 (2018).
4.	Shlyueva, D., Stampfel, G. & Stark, A. Transcriptional enhancers: from properties to genome-wide predictions. Nat. Rev. Genet. 15, 272–286 (2014).
5.	Boyle, A. P. et al. High-resolution mapping and characterization of open chromatin across the genome. Cell 132, 311–322 (2008).
6.	Ong, C.-T. & Corces, V. G. CTCF: an architectural protein bridging genome topology and function. Nat. Rev. Genet. 15, 234–246 (2014).
7.	McKinney, W. Data Structures for Statistical Computing in Python. Proceedings of the 9th Python in Science Conference (2010) doi:10.25080/majora-92bf1922-00a.
8.	GTEx Consortium. The GTEx Consortium atlas of genetic regulatory effects across human tissues. Science 369, 1318–1330 (2020).
9.	Fulco, C. P. et al. Activity-by-contact model of enhancer–promoter regulation from thousands of CRISPR perturbations. Nat. Genet. 51, 1664–1669 (2019).
10.	Abugessaisa, I. et al. refTSS: A Reference Data Set for Human and Mouse Transcription Start Sites. J. Mol. Biol. 431, 2407–2422 (2019).
11.	Roadmap Epigenomics Consortium et al. Integrative analysis of 111 reference human epigenomes. Nature 518, 317–330 (2015).
12.	ENCODE Project Consortium et al. Expanded encyclopaedias of DNA elements in the human and mouse genomes. Nature 583, 699–710 (2020).
13.	Boix, C. A., James, B. T., Park, Y. P., Meuleman, W. & Kellis, M. Regulatory genomic circuitry of human disease loci by integrative epigenomics. Nature 590, 300–307 (2021).
14.	Ernst, J. & Kellis, M. Chromatin-state discovery and genome annotation with ChromHMM. Nat. Protoc. 12, 2478–2492 (2017).
15.	Nasser, J. et al. Genome-wide enhancer maps link risk variants to disease genes. Nature 593, 238–243 (2021).
16.	Histone ChIP-seq data standards and processing pipeline. https://www.encodeproject.org/chip-seq/histone-encode4/.
17.	Dao, L. T. M. & Spicuglia, S. Transcriptional regulation by promoters with enhancer function. Transcription 9, 307–314 (2018).
18.	Dao, L. T. M. et al. Genome-wide characterization of mammalian promoters with distal enhancer functions. Nat. Genet. 49, 1073–1081 (2017).
19.	Andersson, R. & Sandelin, A. Determinants of enhancer and promoter activities of regulatory elements. Nat. Rev. Genet. 21, 71–87 (2020).
20.	Zhang, Z. D. et al. Statistical analysis of the genomic distribution and correlation of regulatory elements in the ENCODE regions. Genome Res. 17, 787–797 (2007).
21.	Keifer, J. Primetime for Learning Genes. Genes  8, (2017).
22.	Quinlan, A. R. & Hall, I. M. BEDTools: a flexible suite of utilities for comparing genomic features. Bioinformatics 26, 841–842 (2010).
23.	Harrow, J. et al. GENCODE: the reference human genome annotation for The ENCODE Project. Genome Res. 22, 1760–1774 (2012).
24.	Liao, Y., Wang, J., Jaehnig, E. J., Shi, Z. & Zhang, B. WebGestalt 2019: gene set analysis toolkit with revamped UIs and APIs. Nucleic Acids Res. 47, W199–W205 (2019).
25.	Kanehisa, M., Sato, Y., Kawashima, M., Furumichi, M. & Tanabe, M. KEGG as a reference resource for gene and protein annotation. Nucleic Acids Res. 44, D457-62 (2016).
26.	Yohe, L. R., Fabbri, M., Hanson, M. & Bhullar, B.-A. S. Olfactory receptor gene evolution is unusually rapid across Tetrapoda and outpaces chemosensory phenotypic change. Curr. Zool. 66, 505–514 (2020).
27.	Buniello, A. et al. The NHGRI-EBI GWAS Catalog of published genome-wide association studies, targeted arrays and summary statistics 2019. Nucleic Acids Res. 47, D1005–D1012 (2019).
28.	Sherry, S. T. et al. dbSNP: the NCBI database of genetic variation. Nucleic Acids Res. 29, 308–311 (2001).
29.	Park, J.-H. et al. Distribution of allele frequencies and effect sizes and their interrelationships for common genetic susceptibility variants. Proc. Natl. Acad. Sci. U. S. A. 108, 18026–18031 (2011).
30.	Evans, P., Cox, N. J. & Gamazon, E. R. The regulatory genome constrains protein sequence evolution: implications for the search for disease-associated genes. PeerJ 8, e9554 (2020).
31.	Mostafavi, H., Spence, J. P., Naqvi, S. & Pritchard, J. K. Limited overlap of eQTLs and GWAS hits due to systematic differences in discovery. bioRxiv 2022.05.07.491045 (2022) doi:10.1101/2022.05.07.491045.
32.	Pan UKBB. https://pan.ukbb.broadinstitute.org.
33.	Azevedo, T., Dimitri, G. M., Lió, P. & Gamazon, E. R. Multilayer modelling of the human transcriptome and biological mechanisms of complex diseases and traits. npj Systems Biology and Applications 7, 1–13 (2021).
34.	Loos, R. J. F. 15 years of genome-wide association studies and no signs of slowing down. Nat. Commun. 11, 5900 (2020).
35.	Uffelmann, E. et al. Genome-wide association studies. Nature Reviews Methods Primers 1, 1–21 (2021).
36.	Stranger, B. E., Stahl, E. A. & Raj, T. Progress and promise of genome-wide association studies for human complex trait genetics. Genetics 187, 367–383 (2011).
37.	Wang, K., Li, M. & Hakonarson, H. ANNOVAR: Functional annotation of genetic variants from high-throughput sequencing data. Nucleic Acids Res. 38, 1–7 (2010).
38.	Khinchin, A. I. Mathematical Foundations of Information Theory. (Dover Publication, 1957).
39.	Hinrichs, A. S. et al. The UCSC Genome Browser Database: update 2006. Nucleic Acids Res. 34, D590-8 (2006).
40.	Feng, J., Liu, T., Qin, B., Zhang, Y. & Liu, X. S. Identifying ChIP-seq enrichment using MACS. Nat. Protoc. 7, 1728–1740 (2012).
41.	Barbeira, A. N. et al. Exploiting the GTEx resources to decipher the mechanisms at GWAS loci. Genome Biol. 22, 49 (2021).
42.	Khan, A. & Mathelier, A. Intervene: a tool for intersection and visualization of multiple gene or genomic region sets. BMC Bioinformatics 18, 287 (2017).
43.	Howe, K. L. et al. Ensembl 2021. Nucleic Acids Res. 49, D884–D891 (2021).
44.	Abugessaisa, I. et al. FANTOM5 CAGE profiles of human and mouse reprocessed for GRCh38 and GRCm38 genome assemblies. Sci Data 4, 170107 (2017).
45.	Zhang, Z. et al. HeRA: an atlas of enhancer RNAs across human tissues. Nucleic Acids Res. 49, D932–D938 (2021).
46.	Duttke, S. H., Chang, M. W., Heinz, S. & Benner, C. Identification and dynamic quantification of regulatory elements using total RNA. Genome Res. 29, 1836–1846 (2019).
47.	Hamosh, A., Scott, A. F., Amberger, J. S., Bocchini, C. A. & McKusick, V. A. Online Mendelian Inheritance in Man (OMIM), a knowledgebase of human genes and genetic disorders. Nucleic Acids Res. 33, D514-7 (2005).
48.	pheatmap: Pretty Heatmaps. Comprehensive R Archive Network (CRAN) https://CRAN.R-project.org/package=pheatmap.
49.	Stelzer, G. et al. The GeneCards Suite: From Gene Data Mining to Disease Genome Sequence Analyses. Curr. Protoc. Bioinformatics 54, 1.30.1-1.30.33 (2016).
50.	Zhao, J. H. gap: Genetic Analysis Package. J. Stat. Softw. 23, 1–18 (2008).
